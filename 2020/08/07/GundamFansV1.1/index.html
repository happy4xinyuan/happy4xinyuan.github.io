<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>GundamFans V1.1 - 心远 XinyuanCai&#039;s Blog</title><meta description="GundamFans意在建立一个高达动漫同好分享网站, 分享自己喜爱的高达机体. 后端主体为nodeJS的express框架, 数据库采用mongoDB, 使用mongoose库进行操作. 前端部分使用ejs来编写网页, 使用bootstrap进行装饰, 具有较好的整合性."><meta property="og:type" content="blog"><meta property="og:title" content="GundamFans V1.1"><meta property="og:url" content="https://www.happy4xinyuan.github.io/2020/08/07/GundamFansV1.1/"><meta property="og:site_name" content="心远 XinyuanCai&#039;s Blog"><meta property="og:description" content="GundamFans意在建立一个高达动漫同好分享网站, 分享自己喜爱的高达机体. 后端主体为nodeJS的express框架, 数据库采用mongoDB, 使用mongoose库进行操作. 前端部分使用ejs来编写网页, 使用bootstrap进行装饰, 具有较好的整合性."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.happy4xinyuan.github.io/img/gf2.png"><meta property="article:published_time" content="2020-08-07T13:26:04.401Z"><meta property="article:modified_time" content="2020-08-11T09:35:55.558Z"><meta property="article:author" content="XinyuanCai"><meta property="article:tag" content="Full Stack"><meta property="article:tag" content="nodejs"><meta property="article:tag" content="express"><meta property="article:tag" content="ejs"><meta property="article:tag" content="mongoDB"><meta property="article:tag" content="Bootstrap"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/gf2.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.happy4xinyuan.github.io/2020/08/07/GundamFansV1.1/"},"headline":"心远 XinyuanCai's Blog","image":["https://www.happy4xinyuan.github.io/img/gf2.png"],"datePublished":"2020-08-07T13:26:04.401Z","dateModified":"2020-08-11T09:35:55.558Z","author":{"@type":"Person","name":"XinyuanCai"},"description":"GundamFans意在建立一个高达动漫同好分享网站, 分享自己喜爱的高达机体. 后端主体为nodeJS的express框架, 数据库采用mongoDB, 使用mongoose库进行操作. 前端部分使用ejs来编写网页, 使用bootstrap进行装饰, 具有较好的整合性."}</script><link rel="canonical" href="https://www.happy4xinyuan.github.io/2020/08/07/GundamFansV1.1/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/longlogo.png" alt="心远 XinyuanCai&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/happy4xinyuan"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="/img/gf2.png" alt="GundamFans V1.1"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-07T13:26:04.401Z" title="2020-08-07T13:26:04.401Z">2020-08-07</time><span class="level-item"><a class="link-muted" href="/categories/Application/">Application</a></span><span class="level-item">10 分钟 读完 (大约 1480 个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">GundamFans V1.1</h1><div class="content"><blockquote>
<p>GundamFans意在建立一个高达动漫同好分享网站, 分享自己喜爱的高达机体.</p>
<p>后端主体为nodeJS的express框架, 数据库采用mongoDB, 使用mongoose库进行操作. 前端部分使用ejs来编写网页, 使用bootstrap进行装饰, 具有较好的整合性.</p>
</blockquote>
<a id="more"></a>

<h1 id="主体文件"><a href="#主体文件" class="headerlink" title="主体文件"></a>主体文件</h1><p>文件树结构:</p>
<blockquote>
<p>D:.<br>│   index.js<br>│   package-lock.json<br>│   package.json</p>
<p>├───public //需要app.use(express.static(“public”));指示express来serve public目录<br>│       global.css //全局css设置<br>│<br>└───views //express 默认文件夹<br>    │   index.ejs<br>    │   landing.ejs<br>    │   newms.ejs<br>    │   show.ejs<br>    │<br>    └───partials //公用代码<br>            header.ejs<br>            tail.ejs</p>
<p>├───node_modules(略)</p>
</blockquote>
<h1 id="关键点"><a href="#关键点" class="headerlink" title="关键点"></a>关键点</h1><ul>
<li><p>框架与库的区别</p>
</li>
<li><p>&lt;%- include(“partials/header”) %&gt;实现头尾部ejs代码公用</p>
</li>
<li><p>post指令无法直接解析req.body.param, 需要body-parser库</p>
</li>
<li><p>ejs中&lt;% %&gt;为逻辑代码不显示, &lt;%= %&gt;为显示代码, &lt;%- %&gt;显示且作为html运行?</p>
</li>
<li><p>&lt;%- %&gt;读取输入时, 对方可以输入&lt;script 代码进行攻击. sanitize消毒</p>
</li>
</ul>
<h1 id="代码逻辑"><a href="#代码逻辑" class="headerlink" title="代码逻辑"></a>代码逻辑</h1><p>首先在本地开启mongoDB, <code>mongod</code></p>
<p>npm库依赖:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; render &#125; = <span class="built_in">require</span>(<span class="string">"ejs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>),</span><br><span class="line">    app = express(),</span><br><span class="line">    bodyparser = <span class="built_in">require</span>(<span class="string">"body-parser"</span>);</span><br><span class="line">    mongoose = <span class="built_in">require</span>(<span class="string">"mongoose"</span>);</span><br></pre></td></tr></table></figure>

<p>相关设置与端口监听:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//指示express来serve public目录</span></span><br><span class="line">app.use(express.static(<span class="string">"public"</span>));</span><br><span class="line"><span class="comment">// 设置使得body自动被parse,可以直接使用req.body.name</span></span><br><span class="line">app.use(bodyparser.urlencoded(&#123;<span class="attr">extended</span>:<span class="literal">true</span>&#125;));</span><br><span class="line"><span class="comment">//默认使用ejs解析views内容</span></span><br><span class="line">app.set(<span class="string">"view engine"</span>,<span class="string">"ejs"</span>);</span><br><span class="line">app.listen(<span class="number">3000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"gundam runnig"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>连接mongoDB, <code>mongoose.connect(&quot;mongodb://localhost:27017/gundam_fans&quot;,{useUnifiedTopology: true,useNewUrlParser: true });</code></p>
<p>构建机体视图schema, 构建模型变量.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> gundamMSSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    img: <span class="built_in">String</span>,</span><br><span class="line">    description: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> gundamMS = mongoose.model(<span class="string">"gundamMS"</span>,gundamMSSchema);</span><br></pre></td></tr></table></figure>

<h3 id="Router设计"><a href="#Router设计" class="headerlink" title="Router设计:"></a>Router设计:</h3><table>
<thead>
<tr>
<th>url</th>
<th>HTTP verb</th>
<th>purpose</th>
<th>对应ejs</th>
</tr>
</thead>
<tbody><tr>
<td>/</td>
<td>get</td>
<td>加载Landing Page</td>
<td>landing</td>
</tr>
<tr>
<td>/wiki</td>
<td>get</td>
<td>展示所有机体信息</td>
<td>index</td>
</tr>
<tr>
<td>/wiki</td>
<td>post</td>
<td>根据页面body表单信息创建机体, redirect(“/wiki”)</td>
<td>-</td>
</tr>
<tr>
<td>/wiki/new</td>
<td>get</td>
<td>加载机体创建表格, &lt; form action=”/wiki” method=”POST” &gt;</td>
<td>newms</td>
</tr>
<tr>
<td>/wiki/:id</td>
<td>get</td>
<td>加载id对应机体详情页</td>
<td>show</td>
</tr>
</tbody></table>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现:"></a>具体实现:</h3><ul>
<li>/wiki get 实现</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">"/wiki"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//获取所有ms信息</span></span><br><span class="line">    <span class="comment">//find()</span></span><br><span class="line">    gundamMS.find(&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,mslist</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.render(<span class="string">"index"</span>,&#123;<span class="attr">mslist</span>: mslist&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>搜索结果mslist, 传入index页, 取出单个结构即为gundamMSSchema, 多了一个”_id”属性.</p>
<p>e.name等属性直接显示, e_id作为参数传入链接MoreInfo. <code>a href=&quot;/wiki/&lt;%= e._id%&gt;&quot;</code></p>
<ul>
<li>通过点击MoreInfo, 进入机体详情页:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示更多机体信息</span></span><br><span class="line">app.get(<span class="string">"/wiki/:id"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//index中的btn link包含_id,利用_id去获取description,(req.params.id获取域名中的参数)</span></span><br><span class="line">    gundamMS.findById(req.params.id,<span class="function"><span class="keyword">function</span>(<span class="params">err,findms</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.render(<span class="string">"show"</span>,&#123;<span class="attr">ms</span>:findms&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>对于url中带有的参数<code>:id</code>使用 <code>req.params.id</code>进行访问.</p>
<ul>
<li>新建机体信息的设置:</li>
</ul>
<p>首先是在<code>wiki/new</code>下render<code>newms</code>页面, 在该页面下提供form. 该表格将信息以POST报文的形式传给<code>/wiki</code>页面.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/wiki"</span> method=<span class="string">"POST"</span> &gt;</span><br><span class="line">                &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                    &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> type=<span class="string">"text"</span> name=<span class="string">"msname"</span> placeholder=<span class="string">"MS name"</span>&gt;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;div class="form-group"&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;input class="form-control" type="text" name="msimg" placeholder="MS picture url"&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>div&gt;</span><br><span class="line">                &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                    &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> type=<span class="string">"text"</span> name=<span class="string">"description"</span> placeholder=<span class="string">"MS description"</span>&gt;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;div class="form-group"&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;button type="submit" class="btn btn-success btn-block"&gt;GO!&lt;/</span>button&gt;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;               </span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;</span><br></pre></td></tr></table></figure>

<p><code>/wiki</code>对POST报文进行响应:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">"/wiki"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> newms = &#123;</span><br><span class="line">        name:req.body.msname,</span><br><span class="line">        img:req.body.msimg,</span><br><span class="line">        description:req.body.description,</span><br><span class="line">    &#125;</span><br><span class="line">    gundamMS.create(newms,<span class="function"><span class="keyword">function</span>(<span class="params">err,newlycreated</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.redirect(<span class="string">"/wiki"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>其中注意页面信息由req.body.msname获取, 注意此处需要提前引入bodyparser依赖:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bodyparser = <span class="built_in">require</span>(<span class="string">"body-parser"</span>);</span><br><span class="line"><span class="comment">// 设置使得body自动被parse,可以直接使用req.body.name</span></span><br><span class="line">app.use(bodyparser.urlencoded(&#123;<span class="attr">extended</span>:<span class="literal">true</span>&#125;));</span><br></pre></td></tr></table></figure>

<h3 id="MongoDB使用整理"><a href="#MongoDB使用整理" class="headerlink" title="MongoDB使用整理:"></a>MongoDB使用整理:</h3><p>首先在本地开启mongoDB, <code>mongod</code></p>
<p>连接mongoDB, <code>mongoose.connect(&quot;mongodb://localhost:27017/gundam_fans&quot;,{useUnifiedTopology: true,useNewUrlParser: true });</code></p>
<p>构建机体视图schema, 构建模型变量.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> gundamMSSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    img: <span class="built_in">String</span>,</span><br><span class="line">    description: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 使用模式“编译”模型</span></span><br><span class="line"><span class="keyword">let</span> gundamMS = mongoose.model(<span class="string">"gundamMS"</span>,gundamMSSchema);</span><br></pre></td></tr></table></figure>

<p>第一个参数是为模型所创建集合的别名（Mongoose 将为 SomeModel 模型创建数据库集合），第二个参数是创建模型时使用的模式。</p>
<h3 id="创建和修改文档"><a href="#创建和修改文档" class="headerlink" title="创建和修改文档"></a>创建和修改文档</h3><p>插入新数据操作:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">gundamMS.create(</span><br><span class="line">    &#123;<span class="attr">name</span>:<span class="string">"ASW-G-08 Gundam Barbatos"</span>,</span><br><span class="line">     img:<span class="string">"..."</span>,</span><br><span class="line">     description:<span class="string">"..."</span></span><br><span class="line">    &#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,ms</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(ms);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>或使用save():</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个 SomeModel 模型的实例</span></span><br><span class="line"><span class="keyword">const</span> awesome_instance = <span class="keyword">new</span> SomeModel(&#123; <span class="attr">name</span>: <span class="string">'牛人'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传递回调以保存这个新建的模型实例</span></span><br><span class="line">awesome_instance.save( <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleError(err);</span><br><span class="line">  &#125; <span class="comment">// 已保存</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>可以使用“圆点”加字段名来访问、修改新记录中的字段。修改后必须调用 <code>save()</code> 或 <code>update()</code> 以将改动保存回数据库。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用圆点来访问模型的字段值</span></span><br><span class="line"><span class="built_in">console</span>.log(awesome_instance.name); <span class="comment">// 控制台将显示 '也是牛人'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改字段内容并调用 save() 以修改记录</span></span><br><span class="line">awesome_instance.name = <span class="string">"酷毙了的牛人"</span>;</span><br><span class="line">awesome_instance.save( <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (err) &#123;</span><br><span class="line">     <span class="keyword">return</span> handleError(err);</span><br><span class="line">   &#125; <span class="comment">// 已保存</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="搜索纪录"><a href="#搜索纪录" class="headerlink" title="搜索纪录"></a>搜索纪录</h3><ul>
<li><code>findById()</code>：用指定 <code>id</code> 查找文档（每个文档都有一个唯一 <code>id</code>）。</li>
<li><code>findOne()</code>：查找与指定条件匹配的第一个文档。</li>
<li><code>findByIdAndRemove()</code>、<code>findByIdAndUpdate()</code>、<code>findOneAndRemove()</code>、 <code>findOneAndUpdate()</code>：通过 <code>id</code> 或条件查找单个文档，并进行更新或删除。以上是更新和删除记录的便利函数。</li>
</ul>
<p>查找获取list of elements:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gundamMS.find(&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">err,mslist</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(mslist);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p>查找获取单个element:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gundamMS.findById(req.params.id,<span class="function"><span class="keyword">function</span>(<span class="params">err,findms</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.render(<span class="string">"show"</span>,&#123;<span class="attr">ms</span>:findms&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>进阶: 以下代码展示了如何在数据库中找到所有网球运动员，并返回运动员姓名和年龄字段。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Athlete = mongoose.model(<span class="string">'Athlete'</span>, yourSchema);</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT name, age FROM Athlete WHERE sport='Tennis'</span></span><br><span class="line">Athlete.find(</span><br><span class="line">  &#123; <span class="string">'sport'</span>: <span class="string">'Tennis'</span> &#125;,</span><br><span class="line">  <span class="string">'name age'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err, athletes</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> handleError(err);</span><br><span class="line">    &#125; <span class="comment">// 'athletes' 中保存一个符合条件的运动员的列表</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>若像上述代码那样指定回调，则查询将立即执行。搜索完成后将调用回调。</p>
<p>若未指定回调，则 API 将返回 <a href="http://mongoosejs.com/docs/api.html#query-js">Query</a> 类型的变量。可以使用该查询对象来构建查询，随后使用 <code>exec()</code> 方法执行（使用回调）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 寻找所有网球运动员</span></span><br><span class="line"><span class="keyword">const</span> query = Athlete.find(&#123; <span class="string">'sport'</span>: <span class="string">'Tennis'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找 name, age 两个字段</span></span><br><span class="line">query.select(<span class="string">'name age'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只查找前 5 条记录</span></span><br><span class="line">query.limit(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 按年龄排序</span></span><br><span class="line">query.sort(&#123; <span class="attr">age</span>: <span class="number">-1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以后某个时间运行该查询</span></span><br><span class="line">query.exec(<span class="function"><span class="keyword">function</span> (<span class="params">err, athletes</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleError(err);</span><br><span class="line">  &#125; <span class="comment">// athletes 中保存网球运动员列表，按年龄排序，共 5 条记录</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line">Athlete.</span><br><span class="line">  find().</span><br><span class="line">  where(<span class="string">'sport'</span>).equals(<span class="string">'Tennis'</span>).</span><br><span class="line">  where(<span class="string">'age'</span>).gt(<span class="number">17</span>).lt(<span class="number">50</span>).  <span class="comment">// 附加 WHERE 查询</span></span><br><span class="line">  limit(<span class="number">5</span>).</span><br><span class="line">  sort(&#123; <span class="attr">age</span>: <span class="number">-1</span> &#125;).</span><br><span class="line">  select(<span class="string">'name age'</span>).</span><br><span class="line">  exec(callback); <span class="comment">// 回调函数的名字是 callback</span></span><br></pre></td></tr></table></figure>

<p>查询还能做更多。请参阅 <a href="http://mongoosejs.com/docs/queries.html">查询</a>（Mongoose 英文文档）</p>
<h3 id="公用html代码"><a href="#公用html代码" class="headerlink" title="公用html代码"></a>公用html代码</h3><p>header部分</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>I'm Gundam!!!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/global.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设计navbar --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>tail部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;p <span class="class"><span class="keyword">class</span></span>=<span class="string">"text-center"</span>&gt;Copyright: XinyuanCai<span class="number">.07</span>/<span class="number">2020</span>&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h3><p>req.body.blog</p>
<p>blog[name]</p>
<p>blog[img]</p>
<p>npm i express-sanitizer</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">form action: <span class="regexp">/xx/</span>_id?method=PUT method=<span class="string">"POST"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> expressSanitizer = <span class="built_in">require</span>(<span class="string">"express-sanitizer"</span>);</span><br><span class="line"><span class="keyword">let</span> methodOverride = <span class="built_in">require</span>(<span class="string">"method-override"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//after bodyparser</span></span><br><span class="line">app.use(expressSanitizer())</span><br><span class="line">app.use(methodOverride(<span class="string">"_method"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 博客的content 我们支持html格式,则...</span></span><br><span class="line"><span class="comment">//&lt;%- %&gt;读取输入时, 对方可以输入&lt;script 代码进行攻击. sanitize消毒消除script部分</span></span><br></pre></td></tr></table></figure>

</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Full-Stack/">Full Stack</a><a class="link-muted mr-2" rel="tag" href="/tags/nodejs/">nodejs</a><a class="link-muted mr-2" rel="tag" href="/tags/express/">express</a><a class="link-muted mr-2" rel="tag" href="/tags/ejs/">ejs</a><a class="link-muted mr-2" rel="tag" href="/tags/mongoDB/">mongoDB</a><a class="link-muted mr-2" rel="tag" href="/tags/Bootstrap/">Bootstrap</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/QR_zfb.jpg" alt="支付宝"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/08/11/GundamFansV1.2/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">GundamFans V1.2</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/08/04/Tree%20BFS%20DFS/"><span class="level-item">Tree BFS DFS</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/logo.png" alt="Xinyuan Cai"></figure><p class="title is-size-4 is-block line-height-inherit">Xinyuan Cai</p><p class="is-size-6 is-block">Front-End Developer, love &#039;gunpla&#039; (japenese robot anime model  kits) &amp; FPS games, enjoy Tech!</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China Mainland</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">13</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/happy4xinyuan" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/happy4xinyuan"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://user.qzone.qq.com/779121147/infocenter"><i class="fab fa-qq"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bootstrap/"><span class="tag">Bootstrap</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ES6%E7%89%B9%E6%80%A7/"><span class="tag">ES6特性</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Front-End/"><span class="tag">Front-End</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Full-Stack/"><span class="tag">Full Stack</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JQuery/"><span class="tag">JQuery</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JS/"><span class="tag">JS</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LC/"><span class="tag">LC</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ejs/"><span class="tag">ejs</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/express/"><span class="tag">express</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs/"><span class="tag">nodejs</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%98%93%E9%94%99/"><span class="tag">易错</span><span class="tag is-grey-lightest">4</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Application/"><span class="level-start"><span class="level-item">Application</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/JS/"><span class="level-start"><span class="level-item">JS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E9%97%B2%E8%B0%88/"><span class="level-start"><span class="level-item">闲谈</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><a class="media-left" href="/2020/08/16/Quick%20Sort%20&amp;%20Merge%20Sort/"><p class="image is-64x64"><img class="thumbnail" src="/img/8-16-2.png" alt="Quick Sort &amp; Merge Sort"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-16T08:44:53.497Z">2020-08-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/16/Quick%20Sort%20&amp;%20Merge%20Sort/">Quick Sort &amp; Merge Sort</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Algorithm/">Algorithm</a></p></div></article><article class="media"><a class="media-left" href="/2020/08/14/GundamFansV1.4/"><p class="image is-64x64"><img class="thumbnail" src="/img/gfv1-3.png" alt="GundamFans V1.4"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-14T03:26:29.217Z">2020-08-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/14/GundamFansV1.4/">GundamFans V1.4</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Application/">Application</a></p></div></article><article class="media"><a class="media-left" href="/2020/08/13/GundamFansV1.3/"><p class="image is-64x64"><img class="thumbnail" src="/img/gfv1-3.png" alt="GundamFans V1.3"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-13T09:50:57.191Z">2020-08-13</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/13/GundamFansV1.3/">GundamFans V1.3</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Application/">Application</a></p></div></article><article class="media"><a class="media-left" href="/2020/08/11/GundamFansV1.2/"><p class="image is-64x64"><img class="thumbnail" src="/img/gfv1-2.png" alt="GundamFans V1.2"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-11T09:05:54.850Z">2020-08-11</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/11/GundamFansV1.2/">GundamFans V1.2</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Application/">Application</a></p></div></article><article class="media"><a class="media-left" href="/2020/08/07/GundamFansV1.1/"><p class="image is-64x64"><img class="thumbnail" src="/img/gf2.png" alt="GundamFans V1.1"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-07T13:26:04.401Z">2020-08-07</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/07/GundamFansV1.1/">GundamFans V1.1</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/Application/">Application</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://johncheunghust.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Best friends blog</span></span><span class="level-right"><span class="level-item tag">johncheunghust.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="http://www.gundam00.net/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">favorite anime</span></span><span class="level-right"><span class="level-item tag">www.gundam00.net</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/longlogo.png" alt="心远 XinyuanCai&#039;s Blog" height="28"></a><p class="size-small"><span>&copy; 2020 XinyuanCai</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/happy4xinyuan"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://www.happy4xinyuan.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>